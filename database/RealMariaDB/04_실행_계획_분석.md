# Real MariaDB - 04. 실행 계획 분석
#TIL/Database/RealMariaDB

---

## 개요

### 쿼리 실행 절차

MariaDB 서버에서 쿼리가 실행되는 과정은 크게 3가지이다.  

- 사용자의 쿼리를 파싱해서 MariaDB 서버가 이해할 수 있는 `SQL 파스 트리`를 만든다.
	- "SQL 파싱"이라고 하며, MariaDB 서버의 "SQL 파서" 모듈이 처리한다.
- 파스 트리를 확인하면서 어떤 테이블부터 읽고 어떤 인덱스를 이용해 테이블을 읽을지 선택한다.
	- "최적화 및 실행 계획 수립" 단계이며, MariaDB 서버의 "옵티마이저"에서 처리한다.
- 두 번째 단계에서 결정된 내용으로 스토리지 엔진으로부터 데이터를 가져온다.  
	- 스토리지 엔진이 데이터를 읽어오면, MariaDB 엔진에서는 스토리지 엔진으로부터 받은 레코드를 조인하거나 정렬하는 작업을 수행한다.


### 옵티마이저의 종류

옵티마이저는 두 가지 방법으로 나눌 수 있는데, 요즘은 대부분의 RDBMS가  `비용 기반 최적화` 방법을 사용한다.  

- 규칙 기반 최적화
	- 대상 테이블의 레코드 건수나 선택도 등을 고려하지 않고 옵티마이저에 내장된 우선순위에 따라 실행 계획을 수립하는 방식이다.
	- 현재는 거의 지원되지 않거나 업데이트 되지 않는 방식이다.
- 비용 기반 최적화
	- 쿼리를 처리하기 위한 여러 가지 가능한 방법을 만들고, 각 단위 작업의 비용(부하) 정보와 대상 테이블의 예측된 통계 정보를 이용해 각 실행 계획 별 비용을 산출한다.

결국 비용 기반 최적화에서 가장 중요한 것은 `통계 정보`다.  

