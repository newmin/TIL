# Real MySQL - 15. 데이터 타입
#TIL/Database/RealMySQL

---

## 칼럼의 데이터 타입 선정

칼럼의 데이터 타입과 길이를 선정할 때 주의해야 할 점은 다음과 같다.  

- 저장되는 값의 성격에 맞는 최적의 타입을 선정
- 가변 길이 칼럼은 최적의 길이를 지정
- 조인 조건으로 사용되는 칼럼은 똑같은 데이터 타입을 선정

너무 긴 길이는 저장 공간의 낭비를 초래하고, 너무 짧은 길이는 추후 스키마 변경 작업 시 많은 부담을 가져오게 되므로 초기 스키마 설정에서 신중하게 조사 후 데이터 타입을 결정해야 한다.  


## 문자열 (CHAR, VARCHAR)

### CHAR와 VARCHAR의 차이

CHAR와 VARCHAR의 가장 큰 차이점은 고정 길이인지 가변 길이인지의 여부다.  

- 고정 길이
	- 실제 입력되는 칼럼 값의 길이에 따라 사용하는 저장 공간의 크기가 변하지 않는다.
- 가변 길이
	- 최대로 저장할 수 있는 값의 길이는 제한돼 있지만, 그 이하 크기의 값이 저장되면 그만큼 저장 공간이 줄어든다.
	- 저장된 값의 유효 크기를 별도로 저장해둬야 하므로 1~2바이트의 저장 공간이 추가로 더 필요하다.

CHAR 타입과 VARCHAR 타입 결정 시 가장 중요한 기준은 다음과 같다.  

- 저장되는 문자열의 길이가 대개 비슷한가?
- 칼럼의 값이 자주 변경되는가?

문자열 칼럼의 값이 변경되는 경우, CHAR 타입 칼럼은 고정 길이 칼럼이기 때문에 저장 공간의 변화 없이 값만 수정하면 된다.  
하지만 VARCHAR 타입은 줄어든 저장 공간 상태에서 그보다 더 큰 길이의 값으로 변경하려면 뒤에 따라오는 레코드의 다음 컬럼들을 이동하는 작업이 필요하다.  

또한 CHAR, VARCHAR 키워드 뒤에 인자로 전달하는 숫자 값은 해당 칼럼의 바이트 크기가 아니라 문자의 수를 의미한다.  
따라서 해당 칼럼에서 사용하는 캐릭터 셋에 따라 실제 바이트 크키가 달라지게 된다.  


### 문자집합 (캐릭터 셋)

문자집합은 CHAR, VARCHAR, TEXT 타입 칼럼에 지정할 수 있으며, MySQL에서는 최종적으로 칼럼 단위로 문자집합을 관리하지만 관리의 편의를 위해 MySQL 서버와 DB, 테이블 단위로 기본 문자집합을 설정할 수 있다.  

- character_set_system
	- MySQL 서버가 식별자를 저장할 때 사용하는 문자집합이다.  
	- 항상 utf8로 설정되며, 사용자가 설정할 필요는 없다.  
- character-set-server
	- MySQL 서버의 기본 문자집합이다.
	- DB, 테이블에 아무런 문자집합이 설정되지 않으면 이 설정이 적용된다.
- character_set_database
	- MySQL DB의 기본 문자집합이다.
- character_set_client
	- MySQL 클라이언트가 보낸 SQL 문장의 인코딩 방식이다.
- character_set_connection
	- MySQL 서버가 클라이언트로부터 전달받은 SQL 문장을 처리하기 위한 문자집합이다.


### 콜레이션(Collation)

`콜레이션`은 **문자열 칼럼의 값에 대한 비교나 정렬 순서를 위한 규칙**을 의미한다.  

```md
latin1_bin
latin1_general_ci
latin1_general_cs
utf8_general_ci
utf8_bin
euckr_korean_ci
euckr_bin
```

- 3개의 파트로 구성된 콜레이션 이름
	- 첫 번째 파트는 문자집합의 이름이다.
	- 두 번째 파트는 해당 문자집합의 하위 분류이다.
	- 세 번째 파트는 대소문자 구분 여부를 나타낸다. "ci"는 대소문자를 구분하지 않는 콜레이션, "cs"는 대소문자를 구분하는 콜레이션이다.
- 2개의 파트로 구성된 콜레이션 이름
	- 첫 번째 파트는 문자집합의 이름이다.
	- 두 번째 파트는 항상 "bin"이다. 이는 이진 데이터를 의미하며, 별도의 콜레이션을 가지지 않음을 의미한다. 비교 및 정렬은 실제 문자 데이터의 바이트 값을 기준으로 수행한다.

"CREATE DATABASE db_test CHARACTER SET=utf8;"과 같이 콜레이션을 지정하지 않았더라도 기본적으로 utf8은 utf8_general_ci로 지정된다.  

중요한 것은 **타입의 이름과 문자열의 길이, 문자집합과 콜레이션까지 일치해야 똑같은 타입이라고 볼 수 있다**는 점이다.  
**모두 일치해야만 조인이나 WHERE 조건이 인덱스를 효율적으로 사용**할 수 있다.  




























