## 1. 도메인 모델 시작

### 도메인

- `도메인` : 소프트웨어로 해결하고자 하는 문제 영역
- 하나의 도메인은 다시 하위 도메인으로 나눌 수 있다.
    - Ex) '온라인 서점' 도메인은 주문, 회원, 혜택, 카탈로그, 리뷰, 정산, 결제, 배송 등의 하위 도메인으로 나눌 수 있다.

### 도메인 모델

- `도메인 모델` : 특정 도메인을 개념적으로 표현한 것
    - 객체 기반으로 표현한 객체 모델 : 기능과 데이터를 함께 표현할 수 있다.
    - 상태 다이어그램을 활용한 상태 모델링

도메인 모델은 도메인 자체를 이해하기 위한 개념 모델이며, 이를 보고 바로 구현 코드를 작성할 수 있는 것은 아니다.  
따라서 구현 시에는 구현 기술에 맞는 별도의 구현 모델이 따로 필요하다.  
물론 구현 모델이 개념 모델을 최대한 따르도록 할 수는 있다. (객체 기반 모델 → 객체 지향 언어 사용)  

각 하위 도메인이 다루는 영역은 서로 다르기 때문에 같은 용어라도 하위 도메인마다 의미가 달라질 수 있다.  
도메인에 따라 용어의 의미가 결정되므로, 여러 하위 도메인을 하나의 다이어그램에 모델링하면 안 된다.  
즉, 모델의 각 구성요소는 특정 도메인을 한정할 때 비로소 의미가 완전해지기 때문에, 각 하위 도메인마다 별도로 모델을 만들어야 한다.  

### 도메인 모델 패턴

도메인 모델 패턴은 바로 전에서 이야기한 도메인 모델과 조금 다르게, 아키텍처상의 도메인 계층을 객체 지향 기법으로 구현하는 패턴을 의미한다.  
애플리케이션의 아키텍처는 다음과 같다.  

- 사용자 인터페이스(UI), 표현(Presentation)
- 응용(Application)
- 도메인
- 인프라스트럭처(Infrastructure)

### 도메인 모델 도출

도메인을 모델링할 때 기본이 되는 작업은 모델을 구성하는 **핵심 구성요소, 규칙, 기능을 찾는 것**이다.  

### 엔티티와 밸류

도출한 모델은 크게 엔티티(Entity)와 밸류(Value)로 구분할 수 있다.  

- 엔티티
    - 가장 큰 특징은 `식별자` 를 갖는다는 것이다.
        - 엔티티의 식별자는 바뀌지 않고 고유하기 때문에 두 엔티티 객체의 식별자가 같으면 두 엔티티는 같다고 판단할 수 있다. (eq & hc 구현 시 식별자만 비교하도록 구현할 수 있다.)
        - 식별자는 다음 중 한 가지 방식으로 생성한다.
            - 특정 규칙에 따라 생성
            - UUID 사용
            - 값을 직접 입력
            - 일련번호 사용(시퀀스나 DB auto_increment 칼럼 사용)
- 밸류
    - 개념적으로 완전한 하나를 표현할 때 사용한다.
    - 밸류 객체의 데이터를 변경할 때는 기존 데이터를 변경하기보다는 변경한 데이터를 갖는 새로운 밸류 객체를 생성하는 방식을 선호한다. `불변`
        - 불변 객체는 참조 투명성과 스레드 안전한 특징을 갖고 있다.
    - 두 밸류 객체가 같은지 비교할 때는 모든 속성을 비교해야 한다.

도메인 객체가 불완전한 상태로 사용되는 것을 막으려면 setter를 열어두지 말고, 생성 시점에 생성자를 통해 필요한 것을 전달해 주어야 한다.  
생성자에서는 전달받은 데이터의 유효성을 생성 시점에 검사할 수 있다.  

### 도메인 용어

도메인에서 사용하는 용어를 코드에 반영하지 않으면 그 코드는 개발자에게 코드의 의미를 해석해야 하는 부담을 준다.
